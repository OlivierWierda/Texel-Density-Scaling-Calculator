<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Texel Density Scale Calculator</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 600px;
            margin: 40px auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .calculator {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        h1 {
            text-align: center;
            color: #4a5568;
            margin-bottom: 10px;
            font-size: 24px;
        }
        
        .subtitle {
            text-align: center;
            color: #718096;
            margin-bottom: 30px;
            font-size: 14px;
        }
        
        .input-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #4a5568;
        }
        
        input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
            box-sizing: border-box;
        }
        
        input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .result {
            background: #f7fafc;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid #667eea;
        }
        
        .scale-factor {
            font-size: 24px;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 10px;
        }
        
        .scale-type {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: inline-block;
            margin-bottom: 15px;
        }
        
        .upscale {
            background: #fed7d7;
            color: #c53030;
        }
        
        .downscale {
            background: #c6f6d5;
            color: #2f855a;
        }
        
        .texture-sizes {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e2e8f0;
        }
        
        .size-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .size-label {
            font-weight: 600;
            color: #4a5568;
        }
        
        .size-value {
            color: #718096;
        }
        
        .difference-row {
            background: #fff5f5;
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            border: 1px solid #feb2b2;
        }
        
        .difference-positive {
            background: #f0fff4;
            border-color: #9ae6b4;
        }
        
        .info-box {
            background: #e6fffa;
            border: 1px solid #81e6d9;
            border-radius: 8px;
            padding: 12px;
            margin-top: 15px;
            font-size: 13px;
            color: #234e52;
        }
    </style>
</head>
<body>
    <div class="calculator">
        <h1>Texel Density Scale Calculator</h1>
        <p class="subtitle">Calculate scaling to match target density between different mesh sizes</p>
        
        <div class="input-group">
            <label for="currentDensity">Current Texture Density (px/cm):</label>
            <input type="number" id="currentDensity" step="0.01" min="0.01" placeholder="e.g. 4.1" value="">
        </div>
        
        <div class="input-group">
            <label for="currentResolution">Current Texture Resolution (pixels):</label>
            <input type="number" id="currentResolution" step="1" min="1" placeholder="e.g. 8096" value="">
        </div>
        
        <div class="input-group">
            <label for="currentMeshSize">Current Mesh Size (meters):</label>
            <input type="number" id="currentMeshSize" step="0.1" min="0.1" placeholder="e.g. 19.75" value="">
        </div>
        
        <div class="input-group">
            <label for="targetMeshSize">Target Mesh Size (meters):</label>
            <input type="number" id="targetMeshSize" step="0.1" min="0.1" placeholder="e.g. 10" value="">
        </div>
        
        <div class="input-group">
            <label for="targetDensity">Target Density (px/cm):</label>
            <input type="number" id="targetDensity" step="0.01" min="0.01" placeholder="e.g. 2.05" value="2.05">
        </div>
        
        <div class="input-group">
            <label for="targetResolution">Target Resolution (pixels) - for comparison:</label>
            <input type="number" id="targetResolution" step="1" min="1" placeholder="e.g. 2048" value="2048">
        </div>
        
        <div id="results" class="result" style="display: none;">
            <div class="scale-factor">
                Scale Factor: <span id="scaleFactor">1.00</span>
            </div>
            <div class="scale-type" id="scaleType">Equal</div>
            <div>
                <strong>Percentage:</strong> <span id="percentage">100%</span>
            </div>
            
            <div class="texture-sizes">
                <h4 style="margin: 0 0 10px 0; color: #4a5568;">Results:</h4>
                <div class="size-row">
                    <span class="size-label">Resultant resolution:</span>
                    <span class="size-value" id="resultantResolution">-</span>
                </div>
                <div class="size-row">
                    <span class="size-label">Achieved density:</span>
                    <span class="size-value" id="achievedDensity">-</span>
                </div>
                <div class="size-row">
                    <span class="size-label">Target resolution:</span>
                    <span class="size-value" id="targetRes">-</span>
                </div>
                
                <div class="difference-row" id="differenceRow">
                    <div style="text-align: center;">
                        <strong>Resolution Difference:</strong><br>
                        <span id="resolutionDifference" style="font-size: 18px; font-weight: bold;">-</span><br>
                        <span id="differencePercent" style="font-size: 14px; color: #718096;">-</span>
                    </div>
                </div>
            </div>
            
            <div class="info-box">
                <strong>How it works:</strong> The scale factor is calculated to achieve the target density when applying the texture to the target mesh size. The formula accounts for how texture density changes with mesh size: Scale = (Target Density × Target Mesh Size) ÷ (Current Density × Current Mesh Size)
            </div>
        </div>
    </div>

    <script>
        const currentDensityInput = document.getElementById('currentDensity');
        const currentResolutionInput = document.getElementById('currentResolution');
        const currentMeshSizeInput = document.getElementById('currentMeshSize');
        const targetMeshSizeInput = document.getElementById('targetMeshSize');
        const targetDensityInput = document.getElementById('targetDensity');
        const targetResolutionInput = document.getElementById('targetResolution');
        const resultsDiv = document.getElementById('results');
        const scaleFactorSpan = document.getElementById('scaleFactor');
        const scaleTypeDiv = document.getElementById('scaleType');
        const percentageSpan = document.getElementById('percentage');
        const resultantResolution = document.getElementById('resultantResolution');
        const achievedDensity = document.getElementById('achievedDensity');
        const targetRes = document.getElementById('targetRes');
        const resolutionDifference = document.getElementById('resolutionDifference');
        const differencePercent = document.getElementById('differencePercent');
        const differenceRow = document.getElementById('differenceRow');
        
        function calculateScale() {
            const currentDensity = parseFloat(currentDensityInput.value);
            const currentResolution = parseFloat(currentResolutionInput.value);
            const currentMeshSize = parseFloat(currentMeshSizeInput.value);
            const targetMeshSize = parseFloat(targetMeshSizeInput.value);
            const targetDensity = parseFloat(targetDensityInput.value);
            const targetResolution = parseFloat(targetResolutionInput.value);
            
            if (!currentDensity || currentDensity <= 0 || !currentResolution || currentResolution <= 0 || 
                !currentMeshSize || currentMeshSize <= 0 || !targetMeshSize || targetMeshSize <= 0 || 
                !targetDensity || targetDensity <= 0 || !targetResolution || targetResolution <= 0) {
                resultsDiv.style.display = 'none';
                return;
            }
            
            // Calculate the scale factor needed to achieve target density
            // Formula: target_density = (current_density * scale_factor * current_mesh_size) / target_mesh_size
            // Solving for scale_factor: scale_factor = (target_density * target_mesh_size) / (current_density * current_mesh_size)
            const scaleFactor = (targetDensity * targetMeshSize) / (currentDensity * currentMeshSize);
            
            // Calculate the resultant resolution after scaling
            const resultantRes = Math.round(currentResolution * scaleFactor);
            
            // Verify the achieved density (should equal target density)
            const verifiedDensity = (currentDensity * scaleFactor * currentMeshSize) / targetMeshSize;
            
            // Calculate difference between resultant and target resolution
            const resDifference = resultantRes - targetResolution;
            const resDifferencePercent = ((resultantRes - targetResolution) / targetResolution) * 100;
            
            const percentage = scaleFactor * 100;
            
            // Update scale factor
            scaleFactorSpan.textContent = scaleFactor.toFixed(4);
            percentageSpan.textContent = percentage.toFixed(1) + '%';
            
            // Update scale type
            if (scaleFactor > 1) {
                scaleTypeDiv.textContent = 'Upscale';
                scaleTypeDiv.className = 'scale-type upscale';
            } else if (scaleFactor < 1) {
                scaleTypeDiv.textContent = 'Downscale';
                scaleTypeDiv.className = 'scale-type downscale';
            } else {
                scaleTypeDiv.textContent = 'No Change';
                scaleTypeDiv.className = 'scale-type';
                scaleTypeDiv.style.background = '#e2e8f0';
                scaleTypeDiv.style.color = '#4a5568';
            }
            
            // Update results
            resultantResolution.textContent = `${resultantRes}×${resultantRes}`;
            achievedDensity.textContent = `${verifiedDensity.toFixed(2)} px/cm (matches target)`;
            targetRes.textContent = `${targetResolution}×${targetResolution}`;
            
            // Update difference display
            if (resDifference > 0) {
                resolutionDifference.textContent = `+${resDifference} pixels`;
                resolutionDifference.style.color = '#2f855a';
                differenceRow.className = 'difference-row difference-positive';
            } else if (resDifference < 0) {
                resolutionDifference.textContent = `${resDifference} pixels`;
                resolutionDifference.style.color = '#c53030';
                differenceRow.className = 'difference-row';
            } else {
                resolutionDifference.textContent = 'Perfect match!';
                resolutionDifference.style.color = '#2f855a';
                differenceRow.className = 'difference-row difference-positive';
            }
            
            differencePercent.textContent = `(${resDifferencePercent > 0 ? '+' : ''}${resDifferencePercent.toFixed(1)}% from target)`;
            
            resultsDiv.style.display = 'block';
        }
        
        currentDensityInput.addEventListener('input', calculateScale);
        currentDensityInput.addEventListener('change', calculateScale);
        currentResolutionInput.addEventListener('input', calculateScale);
        currentResolutionInput.addEventListener('change', calculateScale);
        currentMeshSizeInput.addEventListener('input', calculateScale);
        currentMeshSizeInput.addEventListener('change', calculateScale);
        targetMeshSizeInput.addEventListener('input', calculateScale);
        targetMeshSizeInput.addEventListener('change', calculateScale);
        targetDensityInput.addEventListener('input', calculateScale);
        targetDensityInput.addEventListener('change', calculateScale);
        targetResolutionInput.addEventListener('input', calculateScale);
        targetResolutionInput.addEventListener('change', calculateScale);
        
        // Auto-focus the input
        currentDensityInput.focus();
    </script>
</body>
</html>
